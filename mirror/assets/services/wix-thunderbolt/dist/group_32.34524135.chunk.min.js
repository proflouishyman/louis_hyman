"use strict";(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[8908],{13396:(e,t,n)=>{n.r(t),n.d(t,{PageTransitionsSymbol:()=>l.e$,editor:()=>M,editorPage:()=>O,page:()=>B});var o=n(77748),i=n(20590),s=n(39218),a=n(32166),r=n(94715),l=n(86046),d=n(41596);const p=(0,o.Og)([(0,o.KT)(i.Gp,l.UU),(0,o.KT)(i.wk,l.UU),s.dB,d.s,a.RV,r.wN],(e,t,n,o,i,s)=>{const a=!!i&&"startViewTransition"in i.document&&e.shouldUseViewTransition,r=e.useCssFeatureForViewTransitions;return{name:"pageTransitions",pageWillMount(){if(!r){const t=`<style id="page-transitions">@view-transition {navigation: auto;types: ${e.transitionName}}</style>`;s.setHead(t)}},pageDidMount(o){const i=t.get(),s=i?.mountDoneHandler;s&&s({transitionName:e.transitionName,pageId:o}),(i?.isFirstMount??1)&&n.notifyPageTransitionsCompleted(o),t.update(e=>({...e,isFirstMount:!1}))},pageWillUnmount({contextId:i}){const s=t.get();if(a){const i=()=>{o.getScrollYHistoryState()||o.scrollToTop()},s=e=>{n.notifyPageTransitionsCompleted(e),o.getScrollYHistoryState()&&o.restoreScrollPosition()},a=new Promise(e=>{t.update(t=>({...t,mountDoneHandler:e}))});!function(e,t,n,o){let i;const s=[e.transitionName],a=document.startViewTransition({update:()=>t.then(e=>{i=e.pageId}),types:s});a.ready.then(n),a.finished.then(()=>{o(i)})}(e,a,i,s)}s?.propsUpdateListenersUnsubscribers?.[i]?.(),t.update(e=>{const t=e?.propsUpdateListenersUnsubscribers??{};return delete t[i],{...e,propsUpdateListenersUnsubscribers:t}})}}}),c=(0,o.Og)([(0,o.KT)(i.wk,l.UU)],e=>({disableNextTransition:()=>e.update(e=>({...e,nextTransitionEnabled:!1}))})),u=(0,o.Og)([(0,o.KT)(i.Gp,l.UU)],e=>{let t=[];return{hasTransition:"none"!==e.transitionName,onPageTransitionsCompleted:e=>{t.push(e)},notifyPageTransitionsCompleted:e=>{t.forEach(t=>t(e)),t=[]}}});var g=n(16537),T=n(20636),m=n(87711),y=n(10553),U=n(84448);const b=(0,o.Og)([(0,o.KT)(i.Gp,l.UU),m.Ji,s.dB,d.s,(0,o.KT)(i.wk,l.UU),a.RV,y.n,U.W],(e,t,n,o,i,s,a,r)=>({componentTypes:["Page"],componentWillMount(l){const d=i.get(),p=!d||d.nextTransitionEnabled,c=!d||d.isFirstMount,u=!!s&&"startViewTransition"in s.document&&e.shouldUseViewTransition,g=l.id;t.update({SITE_PAGES:{transitionEnabled:p,...u?{}:{onTransitionStarting:()=>{if(o.getScrollYHistoryState()||o.scrollToTop(a["specs.thunderbolt.pageTransitionScrollSmoothly"]?"smooth":void 0),a["specs.thunderbolt.postTransitionElementFocus"])if(r.isFirstPage()){const e=window.document.getElementById("SCROLL_TO_TOP");e?.focus()}else{const e=window.document.querySelector("main section");e?.focus({preventScroll:!0})}},onTransitionComplete:()=>{n.notifyPageTransitionsCompleted(g),o.getScrollYHistoryState()&&o.restoreScrollPosition()}}}}),i.update(()=>({...d,isFirstMount:c,nextTransitionEnabled:!0}))}}));var f=n(62155),P=n.n(f),w=n(57188);const h=["video.videoInfo.videoId","image.uri","image.link.href","image.displayMode","backgroundImage.uri","backgroundImage.link.href","backgroundImage.displayMode"],k=["type","alignType","fittingType","scrollType","colorOverlay","colorOverlayOpacity","color","opacity"],v=(e,t,n,o)=>o.every(n=>(e&&e[n])===(t&&t[n]))&&n.every(i=>!e&&!t||v(e&&e[i],t&&t[i],n,o)),S=(0,o.Og)([(0,o.KT)(i.Gp,l.UU),m.Ji,(0,o.KT)(i.wk,l.UU),s.Is,s.DR,m.eZ,y.n],(e,t,n,o,i,s,a)=>{const r=(0,w.Pb)(o),l=(i,l)=>{n.update(t=>({...t,pageBackgroundProp:i,pageBackground:e.pageBackground}));const d=a["specs.thunderbolt.pageBGTransitionHandler"],p=n.get()?.lastRenderedPageBgId,c=!p||s.get(p),u=(n.get()?.nextTransitionEnabled??!0)&&l;let g;if(d){const t=e.isEditor&&!e.isPreview;g=u||t&&!c}else g=u||!c;g&&n.update(e=>({...e,lastRenderedPageBgId:r})),t.update({BACKGROUND_GROUP:{key:`BACKGROUND_GROUP_${e.viewMode}`,transitionEnabled:g,className:`backgroundGroup_${o}`}})},d=t=>{const o=n.get(),i=o?.pageBackgroundProp,s=e.pageBackground,a=o?.pageBackground,r=!((e,t)=>{if(!t||!e)return!1;const n=t.mediaRef,o=n&&n.type,i=e.mediaRef,s=i&&i.type,a=!n&&!i,r=a||o===s;let l=[...k];if("WixVideo"===o&&r){const e=l.indexOf("color");l.splice(e,1)}else a&&(l=["color"]);return r&&v(t,e,["mediaRef","imageOverlay"],l)})(s,a);return l=t,!((d=i)&&l&&h.every(e=>P().get(d,e)===P().get(l,e)))||r;var l,d};if(t.get(r)){const e=t.get(r).fillLayers,n=d(e);l(e,n)}const p=t.subscribeToChanges(e=>{if(r in e){const t=e[r]?.fillLayers;d(t)&&l(t,!0)}});return n.update(e=>{const t=e?.propsUpdateListenersUnsubscribers??{};return t[i]=p,{...e||{},propsUpdateListenersUnsubscribers:t}}),{componentTypes:["PageBackground"],componentWillMount(){const e=n.get(),t=e?.isFirstMount??!0;n.update(()=>({...e,isFirstMount:t}))}}}),B=e=>{e(s.dB).to(u),e(l.e$).to(c),e(g.$.PageWillMountHandler,g.$.PageDidMountHandler,g.$.PageWillUnmountHandler).to(p),e(T.ls).to(b),e(T.ls).to(S)},O=e=>{e(g.$.PageDidMountHandler,g.$.PageWillUnmountHandler).to(p),e(T.ls).to(b),e(T.ls).to(S)},M=e=>{e(l.e$).to(c),e(s.dB).to(u)}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/group_32.34524135.chunk.min.js.map